function WPATH(e){var t=e.lastIndexOf("/"),i=-1===t?"nl.fokkezb.cachedImageView/"+e:e.substring(0,t)+"/nl.fokkezb.cachedImageView/"+e.substring(t+1);return i}function Controller(){function e(e){i({image:e})}function t(e){var t=a?a:o.imageView.image;return e&&"string"!=typeof t?t.resolve?t.resolve():t.nativePath?t.nativePath:void 0:t}function i(e){function t(){o.imageView.removeEventListener("load",t),a.write(Ti.UI.createImageView({image:o.imageView.image,width:Ti.UI.SIZE,height:Ti.UI.SIZE,preventDefaultImage:!0}).toImage())}if(e.cacheHires&&r&&(e.image=e.cacheHires,e.hires=!0),!e.image||_.isString(e.image)&&!Ti.Platform.canOpenURL(e.image))delete e.image,n=!1;else if(!e.cacheNot){if(!e.cacheName)if(_.isString(e.image))e.cacheName=e.image;else{if(!e.image.nativePath)throw new Error("For non-file blobs you need to set a cacheName manually.");e.cacheName=e.image.nativePath}if(e.cacheName=Ti.Utils.md5HexDigest(e.cacheName),e.hires&&(e.cacheName=e.cacheName+"@2x"),!e.cacheExtension){var i=/(?:\.([^.]+))?$/,l=i.exec(e.image)[1];e.cacheExtension=l?l:""}a=Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,e.cacheName+"."+e.cacheExtension);var n=!0;a.exists()&&(e.image=a,n=!1)}delete e.id,delete e.cacheName,delete e.cacheExtension,delete e.cacheHires,delete e.$model,delete e.__parentSymbol,o.imageView.applyProperties(e),!0===n&&o.imageView.addEventListener("load",t)}new(require("alloy/widget"))("nl.fokkezb.cachedImageView"),this.__widgetId="nl.fokkezb.cachedImageView",require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="widget",arguments[0]?arguments[0].__parentSymbol:null,arguments[0]?arguments[0].$model:null,arguments[0]?arguments[0].__itemTemplate:null;var o=this,l={};o.__views.imageView=Ti.UI.createImageView({defaultImage:"/nl.fokkezb.cachedImageView/logo.png",id:"imageView"}),o.__views.imageView&&o.addTopLevelView(o.__views.imageView),l.destroy=function(){},_.extend(o,o.__views);var a,n=arguments[0]||{},r="high"===Ti.Platform.displayCaps.density;i(n),Object.defineProperty(o,"image",{get:t,set:e}),l.setImage=e,l.getImage=t,l.init=i,l.applyProperties=i,l.on=l.addEventListener=function(e,t){return o.imageView.addEventListener(e,t)},l.off=l.removeEventListener=function(e,t){return o.imageView.removeEventListener(e,t)},l.trigger=l.fireEvent=function(e,t){return o.imageView.fireEvent(e,t)},_.extend(o,l)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;